#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require_relative "../lib/rebase_pusher"

options = {}

ARGV << '-h' if ARGV.empty?

# https://docs.ruby-lang.org/en/2.1.0/OptionParser.html
OptionParser.new do |opts|
  opts.banner = "Usage: rebase_push -t rebase"

  opts.on_tail("-h", "--help", "Show this message") do
    puts opts
    exit
  end

  opts.on("-t", "--type [TYPE]", %i[rebase reset force_push], "Select operation type (rebase, reset, force_push)") do |t|
    options[:operation_type] = t
  end

  opts.on("-v", "--verbose", "Run verbosely") do |v|
    options[:verbose] = v
  end
end.parse!

RebasePusher.new(options).run
